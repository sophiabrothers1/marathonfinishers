"0","#| label: tbl-predictedvsactual"
"0","#| tbl-cap: Predicted Marathon Finishing Times by Age Group. This boxplot visualizes the predicted marathon times across various age groups, showing how age influences the predicted finishing times."
"0","#| echo: false"
"0","#| eval: true"
"0","#| warning: false"
"0","#| message: false"
"0",""
"0",""
"0","# Generate model predictions for the filtered dataset"
"0","marathon_data_filtered <- marathon_data_cleaned %>%"
"0","  mutate(predicted_time = predict(finisher_model, newdata = marathon_data_cleaned))"
"0",""
"0","# Function to calculate the best group for actual or predicted times"
"0","calculate_best_times <- function(data, group_var, time_col) {"
"0","  data %>%"
"0","    group_by({{ group_var }}) %>%"
"0","    filter(n() > 25) %>% # Only include groups with more than 25 entries"
"0","    summarise("
"0","      best_group = as.character(first({{ group_var }})), # Convert to character for consistency"
"0","      mean_time = mean({{ time_col }}, na.rm = TRUE),"
"0","      count = n()"
"0","    ) %>%"
"0","    ungroup() %>%"
"0","    arrange(mean_time) %>%"
"0","    slice_head(n = 1)"
"0","}"
"0",""
"0","# Calculate the best groups for actual times"
"0","best_age_actual <- calculate_best_times(marathon_data_filtered, age, overall_time_seconds) %>% mutate(category = ""Age"")"
"0","best_gender_actual <- calculate_best_times(marathon_data_filtered, gender, overall_time_seconds) %>% mutate(category = ""Gender"")"
"0","best_race_count_actual <- calculate_best_times(marathon_data_filtered, races_count, overall_time_seconds) %>% mutate(category = ""Races Count"")"
"0","best_iaaf_category_actual <- calculate_best_times(marathon_data_filtered, iaaf_category, overall_time_seconds) %>% mutate(category = ""IAAF Category"")"
"0",""
"0","# Combine actual results into a single table"
"0","actual_table <- bind_rows(best_age_actual, best_gender_actual, best_race_count_actual, best_iaaf_category_actual) %>%"
"0","  select("
"0","    category,"
"0","    best_group, mean_time, count"
"0","  ) %>%"
"0","  rename("
"0","    ""Actual Best Group"" = best_group,"
"0","    ""Actual Mean Time (seconds)"" = mean_time,"
"0","    ""Actual Count"" = count"
"0","  )"
"0",""
"0","# Format the tables for display"
"0","actual_table_display <- kable(actual_table, align = c(""l"", ""l"", ""c"", ""c"")) %>%"
"0","  kable_styling(full_width = FALSE, bootstrap_options = c(""striped"", ""hover"", ""condensed""))"
